{"remainingRequest":"/Users/linqingguang/Documents/文稿/项目/微信实时聊天/client/node_modules/babel-loader/lib/index.js!/Users/linqingguang/Documents/文稿/项目/微信实时聊天/client/src/socket.js","dependencies":[{"path":"/Users/linqingguang/Documents/文稿/项目/微信实时聊天/client/src/socket.js","mtime":1577698399535},{"path":"/Users/linqingguang/Documents/文稿/项目/微信实时聊天/client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/linqingguang/Documents/文稿/项目/微信实时聊天/client/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["export default {\n  // 保证整个项目只有一个socket实例\n  ws: null,\n  // Websocket实例\n  init: function init(config, onMessage, onError) {\n    var _this = this;\n\n    if (!this.ws) {\n      // 实例化socket对象\n      this.ws = new WebSocket(\"ws://localhost:4000/\".concat(config.user.id));\n    } // 客户端接收消息\n\n\n    this.ws.onmessage = function (event) {\n      var message = JSON.parse(event.data);\n      onMessage && onMessage(message); // 接收到消息触发的回调\n    }; // 出错\n\n\n    this.ws.onerror = function (error) {\n      onError && onError(error);\n    };\n\n    this.ws.onclose = function () {\n      _this.ws = null;\n    };\n  },\n  send: function send(msgObj) {\n    // 发送消息的时候触发\n    this.ws.send(JSON.stringify(msgObj));\n  }\n};",{"version":3,"sources":["/Users/linqingguang/Documents/文稿/项目/微信实时聊天/client/src/socket.js"],"names":["ws","init","config","onMessage","onError","WebSocket","user","id","onmessage","event","message","JSON","parse","data","onerror","error","onclose","send","msgObj","stringify"],"mappings":"AAAA,eAAe;AACb;AACAA,EAAAA,EAAE,EAAE,IAFS;AAEH;AACVC,EAAAA,IAHa,gBAGRC,MAHQ,EAGAC,SAHA,EAGWC,OAHX,EAGoB;AAAA;;AAC/B,QAAI,CAAC,KAAKJ,EAAV,EAAc;AACZ;AACA,WAAKA,EAAL,GAAU,IAAIK,SAAJ,+BAAqCH,MAAM,CAACI,IAAP,CAAYC,EAAjD,EAAV;AACD,KAJ8B,CAM/B;;;AACA,SAAKP,EAAL,CAAQQ,SAAR,GAAoB,UAAAC,KAAK,EAAI;AAC3B,UAAIC,OAAO,GAAGC,IAAI,CAACC,KAAL,CAAWH,KAAK,CAACI,IAAjB,CAAd;AACAV,MAAAA,SAAS,IAAIA,SAAS,CAACO,OAAD,CAAtB,CAF2B,CAEM;AAClC,KAHD,CAP+B,CAY/B;;;AACA,SAAKV,EAAL,CAAQc,OAAR,GAAkB,UAAAC,KAAK,EAAI;AACzBX,MAAAA,OAAO,IAAIA,OAAO,CAACW,KAAD,CAAlB;AACD,KAFD;;AAIA,SAAKf,EAAL,CAAQgB,OAAR,GAAkB,YAAM;AACtB,MAAA,KAAI,CAAChB,EAAL,GAAU,IAAV;AACD,KAFD;AAGD,GAvBY;AAwBbiB,EAAAA,IAxBa,gBAwBRC,MAxBQ,EAwBA;AACX;AACA,SAAKlB,EAAL,CAAQiB,IAAR,CAAaN,IAAI,CAACQ,SAAL,CAAeD,MAAf,CAAb;AACD;AA3BY,CAAf","sourcesContent":["export default {\n  // 保证整个项目只有一个socket实例\n  ws: null, // Websocket实例\n  init(config, onMessage, onError) {\n    if (!this.ws) {\n      // 实例化socket对象\n      this.ws = new WebSocket(`ws://localhost:4000/${config.user.id}`);\n    }\n\n    // 客户端接收消息\n    this.ws.onmessage = event => {\n      let message = JSON.parse(event.data);\n      onMessage && onMessage(message); // 接收到消息触发的回调\n    };\n\n    // 出错\n    this.ws.onerror = error => {\n      onError && onError(error);\n    };\n\n    this.ws.onclose = () => {\n      this.ws = null;\n    };\n  },\n  send(msgObj) {\n    // 发送消息的时候触发\n    this.ws.send(JSON.stringify(msgObj));\n  }\n};\n"]}]}